console.log("Hello World! (from create-block-advanced-search-block block)"),document.addEventListener("DOMContentLoaded",async()=>{const e=document.querySelector(".wp-block-create-block-advanced-search-block");if(!e||"1"===e.dataset.asbInit)return;e.dataset.asbInit="1";const t=e.querySelector(".asb-form"),a=e.querySelector(".asb-results"),n=e.querySelector(".asb-pagination"),c=new URLSearchParams(window.location.search);t.q.value=c.get("q")||"";const o=await fetch("/wp-json/wp/v2/categories?per_page=100").then(e=>e.json()),s=t.querySelector(".asb-tags"),l=await fetch("/wp-json/wp/v2/tags?per_page=100").then(e=>e.json()),r=c.getAll("tags[]");l.forEach(e=>{const t=document.createElement("label");t.style.display="block";const a=document.createElement("input");a.type="checkbox",a.name="tags[]",a.value=e.id,r.includes(String(e.id))&&(a.checked=!0),t.appendChild(a),t.append(` ${e.name}`),s.appendChild(t)});const i=t.cat;async function d(e=1){const c=t.q.value,o=t.cat.value,s=new URLSearchParams,l=Array.from(t.querySelectorAll('input[name="tags[]"]:checked')).map(e=>e.value);c&&s.set("q",c),o&&s.set("cat",o),l.forEach(e=>s.append("tags[]",e)),s.set("page",e),history.replaceState({},"",`${location.pathname}?${s}`);const r=await fetch(`/wp-json/advanced-search/v1/posts?${s}`),i=await r.json();a.innerHTML=i.posts.length?i.posts.map(e=>`<p><a href="${e.link}">${e.title}</a></p>`).join(""):"<p>No results.</p>";const p=Math.ceil(i.total/5);if(n.innerHTML="",p<=1)return;function h(e,t,a=!1,c=!1){const o=document.createElement("button");o.textContent=e,a?(o.classList.add("is-active"),o.disabled=!0):c?o.disabled=!0:o.onclick=()=>d(t),n.appendChild(o)}if(h("«",e-1,!1,1===e),e>4){h("1",1);const e=document.createElement("span");e.textContent="…",n.appendChild(e)}const u=Math.max(1,e-2),m=Math.min(p,e+2);for(let t=u;t<=m;t++)h(t,t,t===e);if(e<p-2-1){const e=document.createElement("span");e.textContent="…",n.appendChild(e),h(p,p)}h("»",e+1,!1,e===p)}i.innerHTML='<option value="">All Categories</option>',o.forEach(e=>{const t=document.createElement("option");t.value=e.id,t.textContent=e.name,c.get("cat")==e.id&&(t.selected=!0),i.appendChild(t)}),t.addEventListener("change",()=>d(1)),d(parseInt(c.get("page")||"1",10))});